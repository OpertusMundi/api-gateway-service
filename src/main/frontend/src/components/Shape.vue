<template>
  <div class="shape">
    <svg version="1.1" id="graph" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
     viewBox="0 0 2716 1842" style="enable-background:new 0 0 2716 1842;" xml:space="preserve">
     <defs>
        <filter id="blur" height="300%" width="300%" y="-50%" x="-50%">
            <feGaussianBlur id="gaussianBlur" stdDeviation="10" />
        </filter>
    </defs>
    <g id="circles">
        <circle style="fill:#55F4F0;" cx="1065.9" cy="348.9" r="30"/>
      <!-- <circle style="fill:#55F4F0;" cx="50" cy="350" r="18"/> -->
      <circle style="fill:#55F4F0;" cx="2261.9" cy="848.9" r="24"/>
      <!-- <circle style="fill:#55F4F0;" cx="871.8" cy="157.4" r="37.2"/> -->
      <circle style="fill:#55F4F0;" cx="50" cy="1337.4" r="35"/>
      <circle style="fill:#55F4F0;" cx="2128.6" cy="1356.9" r="12"/>
      <circle style="fill:#55F4F0;" cx="1729.6" cy="1459.9" r="26.4"/>
      <circle style="fill:#55F4F0;" cx="1424.6" cy="875.9" r="13.4"/>
      <!-- <circle style="fill:#55F4F0;" cx="2631.6" cy="1059.9" r="17.4"/> -->
      <circle style="fill:#55F4F0;" cx="1514.6" cy="1708.9" r="11.4"/>
      <!-- <circle style="fill:#55F4F0;" cx="380.6" cy="470.9" r="15.4"/> -->
      <!-- <circle style="fill:#55F4F0;" cx="903.8" cy="1615.7" r="31.7"/> -->
    </g>
    <g id="shape">
      <path style="fill:none;stroke:#190AFF;stroke-width:3;stroke-miterlimit:10;" d="M1559.1,1033.6c-6.6,0.6-13.2,1.2-19.7,1.9
        c-135.6,13.8-273,46.2-375.8,117.1c-50.4,34.8-91.6,78.1-147.3,107.5c-39.5,20.9-85.3,34.1-122.3,57.8
        c-82,52.4-93.6,144-91.9,227.1c0.5,22.8,3.3,47.7,23.3,64.4c39,32.5,96.4,11,152.9,6.1c65.9-5.7,134.6,17.4,175,58.7
        c29.5,30.2,43.7,68,71.2,99.3c27.5,31.3,77.8,56.7,122.8,42.8c49.2-15.1,80.4-54.6,126-75.6c29-13.3,77.6-23.1,139.1-26.6
        c66.5-3.8,112.9,2.5,163.3,30.4c50.4,27.9,100.1,57.9,157.6,75.4c125.4,38.2,271.5,10.2,382.9-49.2
        c111.3-59.4,193.7-146.4,268-234.6c43.8-52,81-95.5,110.4-153.5c7.8-15.4,15-26,13.9-63c-2.2-75.8-186.9-66.1-198.1-141
        c-8.6-57.4,97.2-101.3,75.9-156.6c-7.5-19.4-29.4-33.1-51.5-43.4c-87-40.4-193.7-47.8-293.7-36.2c-71.6,8.3-140.9,25.8-208.6,45.5
        c-26.5,7.7-54.4,16.8-82,23.9c-29.9,7.7-57.5,6.5-88.5,7.9c-36.2,1.6-72.5,2.7-108.7,3.9
        C1688.5,1025.5,1623.6,1027.8,1559.1,1033.6z"/>
      <path style="fill:none;stroke:#222BFD;stroke-width:3;stroke-miterlimit:10;" d="M1244.3,1158.7c-42,28.3-78.4,63-125.3,89.7
        c-3.2,1.8-6.5,3.6-9.8,5.4c-36,18.8-77.9,31.2-111.1,52.4c-73,46.6-84.3,127.9-81.6,200.6c0.8,20,3.8,41.6,21.7,55.9
        c35.5,28,86.3,9.2,136.3,4.5c58.3-5.5,119.3,13.1,155.9,47.9c26.6,25.2,39.9,57.3,64.9,83.8c24.9,26.5,69.5,47.9,109.8,35.7
        c23.4-7.1,42.4-20.1,61.3-33.4c16.4-11.6,32.7-23.6,51.7-31.9c26.5-11.6,69.7-20,124-23c58.9-3.3,100.5,2.3,145.6,26.5
        c18.1,9.7,36.1,19.7,54.4,29.3c27.6,14.3,55.8,27.6,86.2,37.2c86.1,27.3,181,22.4,266.6-5.1c25-8,49.2-18.1,72.1-29.6
        c99.5-50.3,175-126.5,241.5-202.9c41.6-47.8,72.1-87.8,96.7-141.2c6.4-13.9,12.6-23.5,11.3-55.9c-2.7-67.1-163.3-60.7-175-126.5
        c-8.9-50.1,80.2-88.6,60.1-136.6c-7-16.9-26.5-28.8-46.2-37.8c-77.4-35.4-172-41.9-260.7-31.6c-23.5,2.7-46.6,6.6-69.6,11.2
        c-39.2,8-77.6,18.2-115.5,29.2c-23.6,6.8-48.3,14.8-72.7,21.1c-26.5,6.8-51,6.1-78.4,7.5c-32.1,1.7-64.2,2.9-96.3,4.2
        c-57.4,2.4-114.9,4.9-172.1,10.3c-5.8,0.6-11.7,1.1-17.5,1.8C1455.3,1069.3,1334.5,1098,1244.3,1158.7z"/>
      <path style="fill:none;stroke:#2A4DFB;stroke-width:3;stroke-miterlimit:10;" d="M1325,1164.8c-36.9,24.1-70.5,53.6-114.1,78
        c-2.9,1.6-5.8,3.2-8.8,4.8c-32.4,16.8-70.5,28.2-100,47c-64,40.7-75.1,111.9-71.4,174c1.1,17.1,4.2,35.5,20.2,47.4
        c31.8,23.6,76.1,7.4,119.7,2.9c50.8-5.3,103.9,8.8,136.8,37c23.7,20.3,36.2,46.6,58.6,68.2c22.3,21.5,61.2,39,96.7,28.6
        c20.4-6,37.3-17,54.1-28.3c14.6-9.8,29-19.9,45.7-26.8c23.9-9.9,61.9-16.9,108.9-19.4c51.3-2.7,88.2,2.1,127.9,22.6
        c16,8.2,31.8,16.8,48,25c24.5,12.3,49.3,23.9,75.6,32.7c75.4,25,155.8,25.3,231.1,3.8c21.6-6.2,43.1-14.4,63.5-24
        c87.6-41.2,156.5-106.6,215-171.3c39.4-43.5,63.1-80,83.1-129c5-12.3,10.2-21.1,8.6-48.7c-3.2-58.4-139.6-55.3-151.9-111.9
        c-9.3-42.9,63.1-75.9,44.4-116.6c-6.6-14.3-23.6-24.5-40.8-32.2c-67.9-30.3-150.3-36.1-227.6-27c-20.5,2.4-40.7,5.8-60.7,9.8
        c-34.2,7-67.8,15.9-100.8,25.5c-20.6,6-42.2,12.9-63.5,18.4c-23.1,6-44.5,5.7-68.3,7.1c-28,1.7-56,3.1-83.9,4.6
        c-50.1,2.6-100.2,5.3-150,10.4c-5.1,0.5-10.2,1.1-15.2,1.6C1506.9,1089.8,1402.6,1114.2,1325,1164.8z"/>
      <path style="fill:none;stroke:#336EF9;stroke-width:3;stroke-miterlimit:10;" d="M1405.6,1170.9c-31.8,19.8-62.8,44.1-102.9,66.2
        c-2.6,1.4-5.2,2.8-7.9,4.2c-28.9,14.7-63.1,25.3-88.9,41.6c-54.9,34.9-65.9,95.9-61.1,147.5c1.3,14.2,4.7,29.4,18.7,38.9
        c28.2,19.1,66,5.7,103,1.3c43.2-5.1,88.4,4.5,117.7,26.1c20.7,15.3,32.4,35.9,52.3,52.7c19.8,16.6,52.9,30.2,83.7,21.5
        c17.5-5,32.2-14,47-23.1c12.8-7.9,25.3-16.2,39.8-21.8c21.4-8.2,54-13.8,93.8-15.8c43.7-2.1,75.9,1.9,110.3,18.8
        c13.8,6.8,27.6,13.9,41.6,20.7c21.4,10.4,42.7,20.3,65,28.1c64.7,22.8,130.5,28.1,195.6,12.6c18.3-4.4,36.9-10.7,54.8-18.3
        c75.7-32.2,138.2-86.5,188.5-139.6c37.2-39.3,54.2-72.1,69.4-116.8c3.7-10.8,7.7-18.6,6-41.6c-3.8-49.8-115.9-49.8-128.8-97.3
        c-9.7-35.6,46.1-63.2,28.6-96.6c-6.2-11.8-20.7-20.2-35.4-26.6c-58.3-25.3-128.6-30.2-194.6-22.5c-17.5,2-34.8,4.9-51.9,8.5
        c-29.2,6-57.9,13.6-86.1,21.8c-17.7,5.1-36.1,11-54.3,15.7c-19.7,5.1-38,5.2-58.3,6.7c-23.9,1.8-47.7,3.4-71.5,4.9
        c-42.7,2.8-85.4,5.8-127.9,10.5c-4.3,0.5-8.7,1-13,1.5C1558.5,1110,1470.6,1130.5,1405.6,1170.9z"/>
      <path style="fill:none;stroke:#3B90F6;stroke-width:3;stroke-miterlimit:10;" d="M1486.3,1177.1c-26.8,15.6-55,34.7-91.7,54.4
        c-2.3,1.2-4.6,2.4-6.9,3.6c-25.3,12.6-55.7,22.3-77.7,36.2c-45.9,29-56.7,80-50.9,120.9c1.6,11.4,5.2,23.2,17.2,30.4
        c24.6,14.7,55.8,3.9,86.4-0.3c35.6-5,72.9,0.1,98.6,15.2c17.7,10.3,28.6,25.2,46.1,37.1c17.2,11.7,44.6,21.4,70.6,14.4
        c14.6-4,27.2-10.9,39.9-17.9c10.9-6.1,21.7-12.5,33.9-16.7c18.9-6.5,46.2-10.7,78.7-12.2c36.2-1.6,63.5,1.7,92.6,14.9
        c11.7,5.3,23.4,10.9,35.2,16.3c18.4,8.4,36.2,16.6,54.4,23.6c53.9,20.6,105.2,30.9,160,21.5c14.9-2.6,30.6-7,46.2-12.7
        c63.7-23.2,120.1-66.2,162-107.9c35.2-35,45.4-64.1,55.8-104.6c2.4-9.2,5.2-16.2,3.3-34.4c-4.3-41.2-92.1-44.4-105.7-82.7
        c-10-28.3,29.2-50.5,12.9-76.6c-5.8-9.2-17.8-15.8-30-20.9c-48.8-20.2-106.8-24.4-161.6-17.9c-14.5,1.7-28.8,4.1-43,7.1
        c-24.2,5.1-48,11.4-71.5,18.1c-14.7,4.2-29.9,9-45,13c-16.3,4.3-31.5,4.8-48.2,6.3c-19.7,1.9-39.5,3.6-59.1,5.3
        c-35.4,3.1-70.7,6.2-105.8,10.6c-3.6,0.5-7.2,1-10.7,1.4C1610,1130.2,1538.6,1146.6,1486.3,1177.1z"/>
      <path style="fill:none;stroke:#44B1F4;stroke-width:3;stroke-miterlimit:10;" d="M1567,1183.2c-21.8,11.3-47.1,25.3-80.5,42.6
        c-1.9,1-3.9,2-6,3c-21.7,10.6-48.3,19.3-66.6,30.8c-36.8,23.2-47.4,64-40.6,94.4c1.9,8.5,5.7,17.1,15.7,21.9
        c21,10.2,45.7,2.1,69.8-2c28.1-4.8,57.1-4.1,79.5,4.3c14.5,5.5,24.7,14.5,39.8,21.6c14.6,6.8,36.3,12.6,57.6,7.3
        c11.7-2.9,22.1-7.8,32.7-12.7c9.1-4.2,18-8.7,28-11.6c16.4-4.8,38.3-7.6,63.7-8.6c28.6-1,51.2,1.4,74.9,11c9.6,3.8,19.1,8,28.8,12
        c15.3,6.4,29.6,13,43.9,19c43.1,18.4,79.8,33.5,124.5,30.4c11.5-0.8,24.4-3.4,37.5-7c51.6-14.4,102.3-45.7,135.5-76.2
        c33.3-30.6,36.8-55.9,42.1-92.3c1.1-7.6,2.7-13.7,0.7-27.3c-5-32.5-68.3-38.9-82.6-68.1c-10.2-21,12.2-37.8-2.9-56.6
        c-5.3-6.7-14.9-11.5-24.7-15.3c-39.2-15.2-85.1-18.5-128.6-13.4c-11.5,1.4-22.9,3.3-34.2,5.7c-19.3,4.1-38.2,9.1-56.8,14.4
        c-11.7,3.3-23.8,7.1-35.8,10.2c-12.9,3.4-25,4.3-38.1,5.9c-15.6,2-31.2,3.8-46.8,5.6c-28,3.3-55.9,6.7-83.7,10.7
        c-2.8,0.4-5.7,0.9-8.5,1.3C1661.6,1150.3,1606.5,1162.7,1567,1183.2z"/>
      <path style="fill:none;stroke:#4CD3F2;stroke-width:3;stroke-miterlimit:10;" d="M1647.7,1189.3c-16.8,6.9-39.3,16-69.3,30.8
        c-1.6,0.8-3.3,1.6-5,2.4c-18.2,8.5-40.9,16.4-55.5,25.4c-27.8,17.3-38.1,48-30.4,67.9c2.2,5.7,6.2,10.9,14.2,13.4
        c17.5,5.6,35.5,0.4,53.1-3.6c20.5-4.6,41.1-8,60.4-6.6c11.2,0.8,20.8,3.9,33.5,6c11.9,2,28,3.8,44.5,0.1c8.7-1.9,17-4.8,25.6-7.6
        c7.3-2.4,14.4-4.9,22-6.5c13.9-2.9,30.4-4.5,48.6-5c21-0.5,38.9,1.2,57.2,7.1c7.5,2.4,14.9,5,22.4,7.7c12.2,4.4,23.1,9.4,33.3,14.5
        c32.4,16.3,54.3,35.7,89,39.2c8.1,0.8,18.2,0.2,28.9-1.4c39.4-5.8,84.8-24.8,109-44.5c31.8-25.9,28.7-47.7,28.4-80.1
        c0-6,0.2-11.3-2-20.1c-5.8-23.9-44.3-33.5-59.5-53.6c-10.3-13.7-4.9-25.1-18.7-36.6c-4.9-4.1-12.1-7.2-19.3-9.7
        c-29.7-10.1-63.4-12.7-95.6-8.8c-8.5,1-17,2.5-25.3,4.3c-14.3,3.2-28.3,6.8-42.1,10.7c-8.8,2.4-17.7,5.1-26.6,7.5
        c-9.5,2.6-18.6,3.9-28.1,5.5c-11.5,2.1-23,4-34.4,6c-20.6,3.6-41.2,7.1-61.6,10.8c-2.1,0.4-4.2,0.8-6.2,1.2
        C1713.1,1170.2,1674.1,1178.4,1647.7,1189.3z"/>
      <path style="fill:none;stroke:#55F4F0;stroke-width:3;stroke-miterlimit:10;" d="M1900.2,1152.6c-45.7,10.9-87.1,24.8-128.2,35.2
        c-7.4,1.9-30.4,5.6-43.5,7.6c-12.1,1.9-31.4,6.7-58,19c-15,7-36.5,14.6-48.4,21.9c-24.3,14.9-33.9,44.7-7.4,46.3
        c49.9,2.9,67-32.6,154.9-41.5c37.5-3.8,71.3-4.8,105.2,3.8c41.1,10.5,44.8,43.5,76.2,58c20.6,9.5,83.4,3.8,102.8-8.6
        c31-19.9,21.5-39.8,14.8-67.9C2055.5,1172.5,1970.6,1135.7,1900.2,1152.6z"/>
    </g>
    <g id="lines">
      <g id="line5">
        <rect clip-path="url(#line5clip)" x="2252.2" y="1126.7" style="fill:#336EF9;" width="3.6" height="397.4"/>
        <clipPath id="line5clip"><rect x="2252.2" y="1126.7" width="3.6" height="397.4" /></clipPath>
        <circle style="fill:#336EF9;" cx="2254" cy="1127.1" r="21.6" filter="url(#line5blur)"/>
            <filter id="line5blur" height="300%" width="300%" y="-50%" x="-50%"><feGaussianBlur stdDeviation="0" /></filter>
      </g>
      <g id="line6">
        <rect clip-path="url(#line6clip)" x="2146.7" y="542.6" style="fill:#222BFD;" width="3.6" height="435.8"/>
        <clipPath id="line6clip"><rect x="2146.7" y="542.6" width="3.6" height="435.8" /></clipPath>
        <circle style="fill:#222BFD;" cx="2148.5" cy="542.6" r="21.6" filter="url(#line6blur)"/>
            <filter id="line6blur" height="300%" width="300%" y="-50%" x="-50%"><feGaussianBlur stdDeviation="0" /></filter>
      </g>
      <g id="line4">
        <rect clip-path="url(#line4clip)" x="2001.7" y="804.2" style="fill:#44B1F4;" width="3.6" height="640.6"/>
        <clipPath id="line4clip"><rect x="2001.7" y="804.2" width="3.6" height="640.6" /></clipPath>
        <circle style="fill:#44B1F4;" cx="2003.5" cy="804.2" r="21.6" filter="url(#line4blur)"/>
            <filter id="line4blur" height="300%" width="300%" y="-50%" x="-50%"><feGaussianBlur stdDeviation="0" /></filter>
      </g>
      <g id="line2">
        <rect clip-path="url(#line2clip)" x="1654.6" y="656.3" style="fill:#190AFF;" width="3.6" height="371.3"/>
        <clipPath id="line2clip"><rect x="1654.6" y="656.3" width="3.6" height="371.3" /></clipPath>
        <circle style="fill:#190AFF;" cx="1656.4" cy="655.9" r="21.6" filter="url(#line2blur)"/>
            <filter id="line2blur" height="300%" width="300%" y="-50%" x="-50%"><feGaussianBlur stdDeviation="0" /></filter>
      </g>
      <g id="line3">
        <rect clip-path="url(#line3clip)" x="1783.9" y="873" style="fill:#55F4F0;" width="3" height="310.1"/>
        <clipPath id="line3clip"><rect x="1783.9" y="873" width="3.6" height="310.1" /></clipPath>
        <circle style="fill:#55F4F0;" cx="1785.4" cy="873" r="21.6" filter="url(#line3blur)"/>
            <filter id="line3blur" height="300%" width="300%" y="-50%" x="-50%"><feGaussianBlur stdDeviation="0" /></filter>
      </g>
      <g id="line1">
        <rect clip-path="url(#line1clip)" x="1277.3" y="1182.6" style="fill:#222BFD;" width="3.6" height="497"/>
        <clipPath id="line1clip"><rect x="1277.3" y="1182.6" width="3.6" height="497" /></clipPath>
        <circle style="fill:#222BFD;" cx="1279.1" cy="1182.2" r="21.6" filter="url(#line1blur)"/>
            <filter id="line1blur" height="300%" width="300%" y="-50%" x="-50%"><feGaussianBlur stdDeviation="0" /></filter>
      </g>
    </g>
    </svg>
  </div>
</template>
<script>
import { gsap, Power4, Power1 } from 'gsap';
import $ from '@/assets/scripts/jquery_cs';
/* eslint-disable */

export default {
  data() {
    return {
      shape: null,
      tl: [],
      circles_timeline: [],
      firsttimeLines: true,
      firsttimeCircles: true,
    };
  },

  mounted() {
    setTimeout(() => {
      this.playAnimation();
      this.animateCircles();
    },2000);
  },

  methods: {
    playAnimation() {
      let $lines = $('#lines g');
      let prev_lines = lines_to_animate;
      let lines_count = $lines.length;
      // let lines_to_animate_count =  Math.floor(Math.random() * 3) + 1
      let lines_to_animate_count =  1; //one line at time
      let lines_to_animate = this.pickRandom($lines, lines_to_animate_count);
      this.tl.forEach((timeline) => {
          timeline.kill();
      })
      lines_to_animate.forEach((line, index) => {
          let $rect = $(line).find('rect');
          let $clipPath = $(line).find('clipPath');
          // console.log($clipPath);
          let $circle = $(line).find('circle');
          let rect_height = $(line).find('rect').attr('height');
          let $blur = $(line).find('feGaussianBlur');
          this.tl[index] = gsap.timeline({
            onComplete: () => {
                this.playAnimation();
            },
            onUpdate: () => {
            }
          });
          this.tl[index]
          .to($circle[0], {
              duration: (this.firsttimeLines ? 0 : 2),
              opacity: 0
          })
          .set($circle[0], {
              y: 0,
          })
          .set($blur[0], {
              attr: {stdDeviation: 0},
          })
          .set($clipPath[0], {
              y: rect_height,
          })
          .set($rect[0], {
              opacity: 1
          })
          .to($clipPath[0], {
              duration: 4,
              y: 0,
              ease: Power4.easeInOut
          })
          .to($circle[0], {
              duration: 2,
              opacity: 1,
              ease: Power4.easeInOut,
          },"-=1.5")
          .to($blur[0], {
              duration: 5,
              attr: {stdDeviation: 10},
              ease: Power4.easeInOut,
          },"-=2")
          .to($clipPath[0], {
              duration: 4,
              y: rect_height,
              ease: Power4.easeInOut
          },"-=3")
          .to($circle[0], {
              duration: 5,
              y: -this.randomInteger(150, 400),
              ease: Power4.easeInOut,
          },"-=4")
      });
      this.firsttimeLines = false;
    },

    animateCircles() {
      let $circles = $('#circles').find('circle');

      let $circles_to_animate_ = this.pickRandom($circles, 3);
      // let $circles_to_animate = 3;
      
      $circles.each((index, circle) => {
          this.circles_timeline[index] = gsap.timeline({
              repeat:-1,
              paused: true,
              repeatDelay: this.randomInteger(1,3)
          });
          this.circles_timeline[index]
          .to(circle, {
              duration: this.randomInteger(20, 40),
              y: -1 * this.randomInteger(100,600),
              ease: Power1.easeIn,
          })
          .to(circle, {
              duration: 7,
              opacity: 0,
              ease: Power4.easeInOut,
          },"-=4")
          .to(circle, {
              duration: 12,
              scale: 0,
              transformOrigin: 'center center',
              ease: Power4.easeInOut,
          },"-=10")
          .set(circle, {
              y: 0,
              ease: Power4.easeInOut,
          },"-=2")
          .to(circle, {
              duration: 7,
              opacity: 1,
              scale: 1,
              transformOrigin: 'center center',
              ease: Power4.easeInOut,
          },"-=2")

          this.circles_timeline[index].play();
      });
    },

    randomInteger(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    },


    pickRandom(arr, count) {
      // let _arr = [...arr];
      let _arr = arr;
      return[...Array(count)].map( ()=> _arr.splice(Math.floor(Math.random() * _arr.length), 1)[0] ); 
    }
  },
};
</script>
<style lang="scss">
  @import "@/assets/styles/_shape.scss";
</style>
